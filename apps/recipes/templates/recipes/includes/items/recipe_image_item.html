{% load thumbnail %}
{% thumbnail recipe.image "1500x1000" crop="center" upscale=True as image%}
{% with url_name=request.resolver_match.url_name %}
<a
  {% if url_name == 'recipe' %}
    href="{{ image.url }}" target="_blank"
  {% else %}
    href="{% url 'recipe' recipe.id %}" target="_self"
  {% endif %}
  class="link">
    <img
      src="{{ image.url }}"
      alt="{{ recipe.title }}"
      title="{{ recipe.title }}"
      class="{{ img_class }}"
    >
</a>
{% endwith %}
{% endthumbnail %}